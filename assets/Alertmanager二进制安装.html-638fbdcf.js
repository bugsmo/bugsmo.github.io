import{_ as p,r as o,o as l,c,b as n,d as s,e as t,a as e}from"./app-8ca7f52c.js";const r={},i=n("h1",{id:"alertmanager-二进制安装",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#alertmanager-二进制安装","aria-hidden":"true"},"#"),s(" Alertmanager 二进制安装")],-1),u=n("h2",{id:"下载",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#下载","aria-hidden":"true"},"#"),s(" 下载")],-1),k={href:"https://prometheus.io/download/#alertmanager",target:"_blank",rel:"noopener noreferrer"},d=e(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 下载</span>
<span class="token assign-left variable">VERSION</span><span class="token operator">=</span><span class="token number">0.26</span>.0

<span class="token function">wget</span> https://github.com/prometheus/alertmanager/releases/download/v<span class="token variable">\${VERSION}</span>/alertmanager-<span class="token variable">\${VERSION}</span>.linux-amd64.tar.gz

<span class="token comment"># 国内加速可以使用下面的命令下载</span>
<span class="token function">wget</span> https://ghproxy.com/https://github.com/prometheus/alertmanager/releases/download/v<span class="token variable">\${VERSION}</span>/alertmanager-<span class="token variable">\${VERSION}</span>.linux-amd64.tar.gz

<span class="token comment"># 解压</span>
<span class="token function">tar</span> xf alertmanager-<span class="token variable">\${VERSION}</span>.linux-amd64.tar.gz

<span class="token function">mv</span> alertmanager-<span class="token variable">\${VERSION}</span>.linux-amd64/ /data/alertmanager
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="systemd-管理" tabindex="-1"><a class="header-anchor" href="#systemd-管理" aria-hidden="true">#</a> systemd 管理</h2><p>我们是直接在宿主机上运行的，我们可以用 systemd 来管理，创建一个如下所示的 service unit 文件：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&gt;</span>/etc/systemd/system/alertmanager.service<span class="token operator">&lt;&lt;</span><span class="token punctuation">\\</span>EOF
<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Prometheus: the alerting system
<span class="token assign-left variable">Documentation</span><span class="token operator">=</span>http://prometheus.io/docs/
<span class="token assign-left variable">After</span><span class="token operator">=</span>prometheus.service

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/data/alertmanager/alertmanager <span class="token parameter variable">--config.file</span><span class="token operator">=</span>/data/alertmanager/alertmanager.yml
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>always
<span class="token assign-left variable">StartLimitInterval</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">RestartSec</span><span class="token operator">=</span><span class="token number">10</span>

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
EOF
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后就可以使用 systemd 来管理 alertmanager 了：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl daemon-reload

systemctl <span class="token builtin class-name">enable</span> alertmanager <span class="token parameter variable">--now</span>

systemctl status alertmanager
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="简化版快速安装" tabindex="-1"><a class="header-anchor" href="#简化版快速安装" aria-hidden="true">#</a> 简化版快速安装</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 下载</span>
<span class="token assign-left variable">VERSION</span><span class="token operator">=</span><span class="token number">0.26</span>.0

<span class="token comment"># 国内加速可以使用下面的命令下载</span>
<span class="token function">wget</span> https://ghproxy.com/https://github.com/prometheus/alertmanager/releases/download/v<span class="token variable">\${VERSION}</span>/alertmanager-<span class="token variable">\${VERSION}</span>.linux-amd64.tar.gz
<span class="token comment"># 解压</span>
<span class="token function">tar</span> xf alertmanager-<span class="token variable">\${VERSION}</span>.linux-amd64.tar.gz
<span class="token function">mv</span> alertmanager-<span class="token variable">\${VERSION}</span>.linux-amd64/ /data/alertmanager

<span class="token function">cat</span> <span class="token operator">&gt;</span>/etc/systemd/system/alertmanager.service<span class="token operator">&lt;&lt;</span><span class="token punctuation">\\</span>EOF
<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Prometheus: the alerting system
<span class="token assign-left variable">Documentation</span><span class="token operator">=</span>http://prometheus.io/docs/
<span class="token assign-left variable">After</span><span class="token operator">=</span>prometheus.service

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/data/alertmanager/alertmanager <span class="token parameter variable">--config.file</span><span class="token operator">=</span>/data/alertmanager/alertmanager.yml
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>always
<span class="token assign-left variable">StartLimitInterval</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">RestartSec</span><span class="token operator">=</span><span class="token number">10</span>

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
EOF

systemctl daemon-reload
systemctl <span class="token builtin class-name">enable</span> alertmanager <span class="token parameter variable">--now</span>
systemctl status alertmanager
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="邮箱通知配置参考" tabindex="-1"><a class="header-anchor" href="#邮箱通知配置参考" aria-hidden="true">#</a> 邮箱通知配置参考</h2><p>配置参考</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">global</span><span class="token punctuation">:</span>
  <span class="token key atrule">resolve_timeout</span><span class="token punctuation">:</span> 5m
  <span class="token key atrule">smtp_from</span><span class="token punctuation">:</span> <span class="token string">&quot;xxx@163.com&quot;</span>
  <span class="token key atrule">smtp_smarthost</span><span class="token punctuation">:</span> <span class="token string">&quot;smtp.163.com:465&quot;</span>
  <span class="token key atrule">smtp_auth_username</span><span class="token punctuation">:</span> <span class="token string">&quot;xxx@163.com&quot;</span>
  <span class="token key atrule">smtp_auth_password</span><span class="token punctuation">:</span> <span class="token string">&quot;xxx&quot;</span>
  <span class="token key atrule">smtp_require_tls</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
<span class="token key atrule">templates</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;/data/alertmanager/email.tmpl&quot;</span>
<span class="token key atrule">route</span><span class="token punctuation">:</span>
  <span class="token key atrule">group_by</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;alertname&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">group_wait</span><span class="token punctuation">:</span> 30s
  <span class="token key atrule">group_interval</span><span class="token punctuation">:</span> 5m
  <span class="token key atrule">repeat_interval</span><span class="token punctuation">:</span> 1h
  <span class="token key atrule">receiver</span><span class="token punctuation">:</span> <span class="token string">&quot;email&quot;</span>
<span class="token key atrule">receivers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;email&quot;</span>
    <span class="token key atrule">email_configs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">to</span><span class="token punctuation">:</span> <span class="token string">&quot;xx@xx.com&quot;</span>
        <span class="token key atrule">send_resolved</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">html</span><span class="token punctuation">:</span> <span class="token string">&#39;{{template &quot;email-monitor.html&quot; . }}&#39;</span> <span class="token comment">#这里为下方 email.tmpl 自定义的邮箱模板</span>
<span class="token key atrule">inhibit_rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">source_match</span><span class="token punctuation">:</span>
      <span class="token key atrule">severity</span><span class="token punctuation">:</span> <span class="token string">&quot;critical&quot;</span>
    <span class="token key atrule">target_match</span><span class="token punctuation">:</span>
      <span class="token key atrule">severity</span><span class="token punctuation">:</span> <span class="token string">&quot;warning&quot;</span>
    <span class="token key atrule">equal</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;alertname&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dev&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;instance&quot;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重启服务</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl restart alertmanager
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="邮箱通知模版" tabindex="-1"><a class="header-anchor" href="#邮箱通知模版" aria-hidden="true">#</a> 邮箱通知模版</h2><h3 id="自定义邮件通知模版" tabindex="-1"><a class="header-anchor" href="#自定义邮件通知模版" aria-hidden="true">#</a> 自定义邮件通知模版</h3><p>待调试，value 没值。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span><span class="token punctuation">{</span> define <span class="token string">&quot;email-monitor.html&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">-</span> <span class="token keyword">if</span> <span class="token function">gt</span> <span class="token punctuation">(</span>len <span class="token punctuation">.</span>Alerts<span class="token punctuation">.</span>Firing<span class="token punctuation">)</span> <span class="token number">0</span> <span class="token operator">-</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>告警<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>table border<span class="token operator">=</span><span class="token string">&quot;5&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>报警项<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>实例<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>报警详情<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>报警阀值<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>开始时间<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token punctuation">{</span> range $i<span class="token punctuation">,</span> <span class="token literal-property property">$alert</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token punctuation">.</span>Alerts <span class="token punctuation">}</span><span class="token punctuation">}</span>
            <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span><span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> index $alert<span class="token punctuation">.</span>Labels <span class="token string">&quot;alertname&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> index $alert<span class="token punctuation">.</span>Labels <span class="token string">&quot;instance&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> index $alert<span class="token punctuation">.</span>Annotations <span class="token string">&quot;description&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> index $alert<span class="token punctuation">.</span>Value <span class="token string">&quot;value&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> $alert<span class="token punctuation">.</span>StartsAt<span class="token punctuation">.</span>Format <span class="token string">&quot;2006-01-02 15:04:05&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token punctuation">{</span> end <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span> end <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">-</span> <span class="token keyword">if</span> <span class="token function">gt</span> <span class="token punctuation">(</span>len <span class="token punctuation">.</span>Alerts<span class="token punctuation">.</span>Resolved<span class="token punctuation">)</span> <span class="token number">0</span> <span class="token operator">-</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>恢复<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>table border<span class="token operator">=</span><span class="token string">&quot;5&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>报警项<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>实例<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>报警详情<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>报警阀值<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span>开始时间<span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token punctuation">{</span> range $i<span class="token punctuation">,</span> <span class="token literal-property property">$alert</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token punctuation">.</span>Alerts <span class="token punctuation">}</span><span class="token punctuation">}</span>
            <span class="token operator">&lt;</span>tr<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> index $alert<span class="token punctuation">.</span>Labels <span class="token string">&quot;alertname&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> index $alert<span class="token punctuation">.</span>Labels <span class="token string">&quot;instance&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> index $alert<span class="token punctuation">.</span>Annotations <span class="token string">&quot;description&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> index $alert<span class="token punctuation">.</span>Annotations <span class="token string">&quot;value&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>td<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> $alert<span class="token punctuation">.</span>StartsAt<span class="token punctuation">.</span>Format <span class="token string">&quot;2006-01-02 15:04:05&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token punctuation">{</span> end <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span> end <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">-</span> end <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="官方邮件通知模版" tabindex="-1"><a class="header-anchor" href="#官方邮件通知模版" aria-hidden="true">#</a> 官方邮件通知模版</h3>`,18),v={href:"https://github.com/prometheus/alertmanager/blob/main/template/email.tmpl",target:"_blank",rel:"noopener noreferrer"},m=n("ul",null,[n("li",null,[n("code",null,"email.default.subject"),s(" 是标题")]),n("li",null,[n("code",null,"email.default.html"),s(" 模板，分组集合告警。")])],-1),b=n("h2",{id:"webhooks",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#webhooks","aria-hidden":"true"},"#"),s(" Webhooks")],-1),g=n("h3",{id:"钉钉通知配置参考",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#钉钉通知配置参考","aria-hidden":"true"},"#"),s(" 钉钉通知配置参考")],-1),h={href:"https://github.com/bugsmo/infra-prometheus-webhook",target:"_blank",rel:"noopener noreferrer"},y=e(`<ul><li><code>http://127.0.0.1:8099/alerts/dingtalk/p0</code> 自己部署的 webhook 服务地址</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">global</span><span class="token punctuation">:</span>
  <span class="token key atrule">resolve_timeout</span><span class="token punctuation">:</span> 5m
<span class="token key atrule">route</span><span class="token punctuation">:</span>
  <span class="token key atrule">group_by</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;alertname&quot;</span><span class="token punctuation">]</span>
  <span class="token key atrule">group_wait</span><span class="token punctuation">:</span> 30s
  <span class="token key atrule">group_interval</span><span class="token punctuation">:</span> 5m
  <span class="token key atrule">repeat_interval</span><span class="token punctuation">:</span> 1h
  <span class="token key atrule">receiver</span><span class="token punctuation">:</span> <span class="token string">&quot;default-receiver_web.hook&quot;</span>
<span class="token key atrule">receivers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;default-receiver_web.hook&quot;</span>
    <span class="token key atrule">webhook_configs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">url</span><span class="token punctuation">:</span> <span class="token string">&quot;http://127.0.0.1:8099/alerts/dingtalk/p0&quot;</span>
<span class="token key atrule">inhibit_rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">source_match</span><span class="token punctuation">:</span>
      <span class="token key atrule">severity</span><span class="token punctuation">:</span> <span class="token string">&quot;critical&quot;</span>
    <span class="token key atrule">target_match</span><span class="token punctuation">:</span>
      <span class="token key atrule">severity</span><span class="token punctuation">:</span> <span class="token string">&quot;warning&quot;</span>
    <span class="token key atrule">equal</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;alertname&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dev&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;instance&quot;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2);function q(f,_){const a=o("ExternalLinkIcon");return l(),c("div",null,[i,u,n("p",null,[s("由于 alertmanager 是一个独立的二进制文件，可以直接从 "),n("a",k,[s("Prometheus 下载页面"),t(a)]),s(" 下载解压运行：")]),d,n("p",null,[n("a",v,[s("Github 地址"),t(a)])]),m,b,g,n("p",null,[s("alertmanager 不支持钉钉通知，通过"),n("a",h,[s("第三方 webhook"),t(a)]),s("实现钉钉通知，需要自行按照文档部署 webhook 服务。")]),y])}const w=p(r,[["render",q],["__file","Alertmanager二进制安装.html.vue"]]);export{w as default};
